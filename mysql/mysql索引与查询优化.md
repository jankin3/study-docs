# mysql索引与查询优化

## 什么是索引？为什么索引可以加速？

### 索引是存储引擎快速查找记录的一种数据结构，因为索引一般是有序的，可以将随机I/O转化成顺序I/O,所以查找一般比非索引快。

## 索引的类型

### B-Tree索引

- 优点，顺序存储范围查找快速，前缀查找，等值查找
- 缺点，1. 联合索引顺序很重要，不按照顺序或者跳过可能无法使用索引。2.范围查找列之后的列无法使用索引

### 哈希索引

- 优点，适合等值查找
- 缺点，无法适用于范围查找，无法用于排序，维护的代价比较高（哈希冲突）

### 其他，如空间索引，全文索引

## 索引的存储方式

### 聚簇索引

- 概览：Innodb 是把在同一个数据结构中存储了索引和数据行
- 优点：1. 数据集中，减少I/O 2. 数据获取更快，因为数据和索引存在一起
- 缺点：1. 插入速度依赖于插入顺序 2. 更新主键或者聚簇索引非常麻烦

### 覆盖索引

- 概览：索引包含查询字段所需要的值
- 优点：1. 数量少于全表 2.顺序查找 3. 避免二次查找

## 索引排序

### mysql排序原理

- 1. 通过排序操作 
- 2. 通过索引顺序查找。如果type为index标识使用索引扫描排序

### 限制

- 顺序和索引顺序保持一致，或者where等地方用到
- 当连表的时候只有主表的索引可以被用上

## 索引策略和优化查询

### 索引策略

- 多列索引,并建立合适的索引顺序
- 覆盖索引可以直接获取到数据

### 优化查询

- 优化数据访问，是否请求了多余的数据
- 切分复杂的查询
- 关联子查询优化为连表查询

*XMind - Trial Version*