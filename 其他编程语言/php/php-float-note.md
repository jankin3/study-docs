# php浮点数运算
浮点数运算的“锅”
```php
//加
$a = 0.1;
$b = 0.7;
$c = intval(($a + $b) * 10);
echo $c."<br>";
//输出：7
```
### 1. 原因解释
PHP 官方手册解释如下：
浮点数的精度有限。尽管取决于系统，PHP 通常使用 IEEE 754 双精度格式，则由于取整而导致的最大相对误差为 1.11e-16。非基本数学运算可能会给出更大误差，并且要考虑到进行复合运算时的误差传递。永远不要相信浮点数结果精确到了最后一位，也永远不要比较两个浮点数是否相等。如果确实需要更高的精度，应该使用 任意精度数学函数 或者 gmp 函数.

总结就是`无法使用二进制精确的表示小数`。
> 小数转化为二进制, 转换过程如下：
将小数乘以2，取整数部分表示第一位；
将小数部分乘以2，取整数部分表示第二位；
再将小数部分乘以2，取整数部分表示第三位；
... 依次类推，直到小数部分为0；

### 2. 解决方案
 `任意精度数学函数`。
 对于任意精度的数学，PHP 提供了支持用字符串表示的任意大小和精度的数字的二进制计算。
BCMath：BC 是 Binary Calculator 的缩写。
官方手册：http://php.net/manual/zh/book.bc.php
大家在使用前，请先确认是否已安装 bcmath。
其中常见的算术运算都有。
```phpz
　　bcadd — 将两个高精度数字相加
　　bccomp — 比较两个高精度数字，返回-1, 0, 1
　　bcdiv — 将两个高精度数字相除
　　bcmod — 求高精度数字余数
```

### 3. 拓展
- mysql 存在，建议不要使用浮点数类型。浮点数存在误差，当我们使用精度敏感的数据时，应该使用定点数（decimal）进行存储。
- 其他语言也存在相应的问题
### 总结
浮点数相关问题是一个普遍问题，因为底层的实现等原因无法避免。
以后，在使用浮点数运算的时候，一定要慎重。